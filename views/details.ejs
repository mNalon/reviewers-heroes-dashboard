<!DOCTYPE html>
<html>
<%- include('head'); %>

  <body>
    <div class="details-container">
      <header class="details-header">
        <a href="/" class="back-btn">←</a>
        <h1 class="details-title">Detalhes do Revisor</h1>
      </header>

      <main class="details-main">
        <section class="details-section">
          <h2 class="section-title">MRs atribuídos como revisor</h2>
          <div class="table-container">
            <table class="details-table">
              <thead>
                <tr>
                  <th>Título</th>
                  <th>Data de criação</th>
                  <th>Data de atualização</th>
                  <th>Autor</th>
                  <th class="center">Link</th>
                  <th>Tempo estimado (min)</th>
                </tr>
              </thead>
              <tbody>
                <% openedReviewMRs.forEach(function(mr){ %>
                  <tr>
                    <td class="title-cell" title="<%= mr.title %>">
                      <%= mr.title %>
                    </td>
                    <td class="date-cell">
                      <% if (mr.createdAt) { %>
                        <%= new Date(mr.createdAt).toLocaleDateString('pt-BR', { day: '2-digit' , month: '2-digit' ,
                          year: 'numeric' }) %>
                          <% } else { %>
                            -
                            <% } %>
                    </td>
                    <td class="date-cell">
                      <% if (mr.updatedAt) { %>
                        <%= new Date(mr.updatedAt).toLocaleDateString('pt-BR', { day: '2-digit' , month: '2-digit' ,
                          year: 'numeric' }) %>
                          <% } else { %>
                            -
                            <% } %>
                    </td>
                    <td>
                      <%= mr.author && mr.author.userName %>
                    </td>
                    <td class="link-cell">
                      <a href="<%=mr.webUrl%>" class="link-btn" target="_blank">Ver MR</a>
                    </td>
                    <td class="time-cell">
                      <%= mr.timeEstimate ? mr.timeEstimate/60 : 'Não especificado' %>
                    </td>
                  </tr>
                  <% }); %>
                    <tr class="total-row">
                      <td colspan="4" class="total-mobile"><strong>Total:</strong></td>
                      <td colspan="5" class="total-desktop"><strong>Total:</strong></td>
                      <td><strong>
                          <%=totalOpenedReviewEstimatedTime%>
                        </strong></td>
                    </tr>
              </tbody>
            </table>
          </div>
        </section>

        <section class="details-section">
          <h2 class="section-title">MRs abertos (assignee)</h2>
          <div class="table-container">
            <table class="details-table">
              <thead>
                <tr>
                  <th>Título</th>
                  <th>Data de criação</th>
                  <th>Data de atualização</th>
                  <th>Revisor</th>
                  <th class="center">Link</th>
                  <th>Tempo estimado (min)</th>
                </tr>
              </thead>
              <tbody>
                <% openedMRs.forEach(function(mr){ %>
                  <tr>
                    <td class="title-cell" title="<%= mr.title %>">
                      <%= mr.title %>
                    </td>
                    <td class="date-cell">
                      <% if (mr.createdAt) { %>
                        <%= new Date(mr.createdAt).toLocaleDateString('pt-BR', { day: '2-digit' , month: '2-digit' ,
                          year: 'numeric' }) %>
                          <% } else { %>
                            -
                            <% } %>
                    </td>
                    <td class="date-cell">
                      <% if (mr.updatedAt) { %>
                        <%= new Date(mr.updatedAt).toLocaleDateString('pt-BR', { day: '2-digit' , month: '2-digit' ,
                          year: 'numeric' }) %>
                          <% } else { %>
                            -
                            <% } %>
                    </td>
                    <td>
                      <%= mr.revisor && mr.revisor.userName %>
                    </td>
                    <td class="link-cell">
                      <a href="<%=mr.webUrl%>" class="link-btn" target="_blank">Ver MR</a>
                    </td>
                    <td class="time-cell">
                      <%= mr.timeEstimate ? mr.timeEstimate/60 : 'Não especificado' %>
                    </td>
                  </tr>
                  <% }); %>
                    <tr class="total-row">
                      <td colspan="4" class="total-mobile"><strong>Total:</strong></td>
                      <td colspan="5" class="total-desktop"><strong>Total:</strong></td>
                      <td><strong>
                          <%=totalOpenedEstimatedTime%>
                        </strong></td>
                    </tr>
              </tbody>
            </table>
          </div>
        </section>

        <section class="details-section">
          <h2 class="section-title">MRs revisados e fechados na última semana</h2>
          <div class="table-container">
            <table class="details-table">
              <thead>
                <tr>
                  <th>Título</th>
                  <th>Data de criação</th>
                  <th>Autor</th>
                  <th>Mergeado por</th>
                  <th class="center">Link</th>
                  <th>Tempo estimado (min)</th>
                </tr>
              </thead>
              <tbody>
                <% mergedMRs.forEach(function(mr){ %>
                  <tr>
                    <td class="title-cell" title="<%= mr.title %>">
                      <%= mr.title %>
                    </td>
                    <td class="date-cell">
                      <% if (mr.createdAt) { %>
                        <%= new Date(mr.createdAt).toLocaleDateString('pt-BR', { day: '2-digit' , month: '2-digit' ,
                          year: 'numeric' }) %>
                          <% } else { %>
                            -
                            <% } %>
                    </td>
                    <td>
                      <%= mr.author && mr.author.userName %>
                    </td>
                    <td>
                      <%= mr.mergedBy.userName %>
                    </td>
                    <td class="link-cell">
                      <a href="<%=mr.webUrl%>" class="link-btn" target="_blank">Ver MR</a>
                    </td>
                    <td class="time-cell">
                      <%= mr.timeEstimate ? mr.timeEstimate/60 : 'Não especificado' %>
                    </td>
                  </tr>
                  <% }); %>
                    <tr class="total-row">
                      <td colspan="4" class="total-mobile"><strong>Total:</strong></td>
                      <td colspan="5" class="total-desktop"><strong>Total:</strong></td>
                      <td><strong>
                          <%=totalMergedEstimatedTime%>
                        </strong></td>
                    </tr>
              </tbody>
            </table>
          </div>
        </section>
      </main>
    </div>
  </body>

</html>